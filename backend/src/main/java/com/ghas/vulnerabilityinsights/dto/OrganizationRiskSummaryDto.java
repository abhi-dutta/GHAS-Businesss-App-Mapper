package com.ghas.vulnerabilityinsights.dto;

import lombok.Data;
import lombok.Builder;
import lombok.NoArgsConstructor;
import lombok.AllArgsConstructor;

import com.fasterxml.jackson.annotation.JsonProperty;
import java.time.LocalDateTime;

/**
 * Data Transfer Object for Organization Risk Summary information.
 */
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class OrganizationRiskSummaryDto {
    
    @JsonProperty("organizationName")
    private String organizationName;
    
    @JsonProperty("codeScanning")
    private VulnerabilityStatsDto codeScanning;
    
    @JsonProperty("secretScanning")
    private VulnerabilityStatsDto secretScanning;
    
    @JsonProperty("dependabot")
    private VulnerabilityStatsDto dependabot;
    
    @JsonProperty("totalRepositories")
    private Integer totalRepositories;
    
    @JsonProperty("totalAlerts")
    private Integer totalAlerts;
    
    @JsonProperty("riskScore")
    private Double riskScore;
    
    @JsonProperty("lastUpdated")
    private LocalDateTime lastUpdated;
    
    /**
     * Data Transfer Object for Vulnerability Statistics.
     */
    @Data
    @Builder
    @NoArgsConstructor
    @AllArgsConstructor
    public static class VulnerabilityStatsDto {
        
        @JsonProperty("total")
        private Integer total;
        
        @JsonProperty("critical")
        private Integer critical;
        
        @JsonProperty("high")
        private Integer high;
        
        @JsonProperty("medium")
        private Integer medium;
        
        @JsonProperty("low")
        private Integer low;
        
        @JsonProperty("error")
        private Integer error;
        
        @JsonProperty("unknown")
        private Integer unknown;
    }
}
